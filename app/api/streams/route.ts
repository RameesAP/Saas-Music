import { NextRequest, NextResponse } from "next/server";
import { z } from "zod";
import { prismaClient } from "@/app/lib/db";
//@ts-ignore
import youtubesearchapi from "youtube-search-api";
import { YT_REGEX } from "@/app/lib/utils";



const CreateStreamSchema = z.object({
  createrId: z.string(),
  url: z.string(),
});

export async function POST(req: NextRequest) {
  try {
    const data = CreateStreamSchema.parse(await req.json());
    const isYt = data.url.match(YT_REGEX);
    if (!isYt) {
      return NextResponse.json(
        {
          message: "Wrong url format",
        },
        {
          status: 411,
        }
      );
    }

    const extractedId = data.url.split("?v=")[1];

    const res = await youtubesearchapi.GetVideoDetails(extractedId);

    const thumbnails = res.thumbnail.thumbnails;
    thumbnails.sort((a: { width: number }, b: { width: number }) =>
      a.width < b.width ? -1 : 1
    );

    const stream = await prismaClient.stream.create({
      data: {
        userId: data.createrId,
        url: data.url,
        extractedId,
        type: "Youtube",
        title: res.title ?? "Cant find video",
        smallImg:
          (thumbnails.length > 1
            ? thumbnails[thumbnails.length - 2].url
            : thumbnails[thumbnails.length - 1].url) ?? "data:image/jpeg;base64,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",
        bigImg: thumbnails[thumbnails.length - 1].url ?? "data:image/jpeg;base64,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",
     
      },
    });
    return NextResponse.json({
     ...stream,
     hasUpvoted: false,
      upvotes: 0
    });
  } catch (error) {
    console.log(error);
    
    return NextResponse.json(
      {
        message: "Error while adding a stream",
      },
      {
        status: 411,
      }
    );
  }
}

export async function GET(req: NextRequest) {
  const creatorId = req.nextUrl.searchParams.get("creatorId");
  const streams = await prismaClient.stream.findMany({
    where: {
      userId: creatorId ?? "",
    },
  });
  return NextResponse.json({
    streams,
  });
}
